- name: "RHSM | Register (safe, NO shell, single call)"
  ansible.builtin.command:
    argv:
      - subscription-manager
      - register
      - --activationkey
      - "{{ satellite_register_ak | trim }}"
      - --org
      - "{{ satellite_register_org | trim }}"
      - "{{ (satellite_register_force | default(false)) | ternary('--force', omit) }}"
  register: rhsm_register
  failed_when: rhsm_register.rc != 0